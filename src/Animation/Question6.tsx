import React, { useState } from 'react';
import { CommandTable } from '../CommandTable';
import { DebugTable } from '../DebugTable';
import { useKeyPress } from '../Functions';
import { useTimer } from '../Functions/useTimer';
import Style from '../style.module.scss';

const PPosition = (arc: number): { cx: number; cy: number } => {
    const { sin, cos, PI } = Math;
    const base = { cx: 1038, cy: 865 };
    const radius = 450;
    return {
        cx: base.cx + radius * (1 - cos((PI * arc) / 180)),
        cy: base.cy + radius * sin((PI * arc) / 180),
    };
};

export const Question6 = () => {
    const [speed, setSpeed] = useState(0);
    const { time, pause, reset } = useTimer();
    const [display2, setDisplay2] = useState(false);
    const [display3, setDisplay3] = useState(false);
    useKeyPress('Space', pause);
    useKeyPress('KeyS', pause);
    useKeyPress('KeyR', reset);
    useKeyPress('KeyQ', () => setSpeed((s) => s + 1));
    useKeyPress('KeyA', () => setSpeed((s) => s - 1));
    useKeyPress('KeyZ', () => setSpeed(0));
    useKeyPress('Digit1', () => {
        setDisplay2(false);
        setDisplay3(false);
    });
    useKeyPress('Digit2', () => setDisplay2((b) => !b));
    useKeyPress('Digit3', () => setDisplay3((b) => !b));
    return (
        <div className={Style.AnimationContainer}>
            <DebugTable
                options={{
                    time: time,
                    speed: (2 ** speed).toPrecision(5),
                }}
            />
            <CommandTable
                options={{
                    '1': '初期状態',
                    '2': '小物体Pの運動',
                    q: 'スピードアップ',
                    a: 'スピードダウン',
                    z: 'スピードリセット',
                    r: 'タイマーリセット',
                    s: 'タイマースタート',
                }}
            />
            <h1 className={Style.Title}>問6</h1>
            <svg
                className={Style.SVG}
                viewBox='0 0 4096 2755'
                fill='none'
                xmlns='http://www.w3.org/2000/svg'
            >
                <g opacity='0.3'>
                    <rect
                        y='1825'
                        width='4096'
                        height='200'
                        fill='#222222'
                        stroke='white'
                        strokeWidth='3'
                    />
                    <text
                        x='2048'
                        y='1925'
                        fill='white'
                        fontSize='100'
                        textAnchor='middle'
                        dominantBaseline='central'
                    >
                        床
                    </text>
                    <circle
                        cx='3012'
                        cy='1765'
                        r='59.5'
                        fill='#222222'
                        stroke='white'
                        strokeWidth='3'
                    />
                    <path
                        d='M1143.5 1765C1143.5 1797.86 1116.86 1824.5 1084 1824.5C1051.14 1824.5 1024.5 1797.86 1024.5 1765C1024.5 1732.14 1051.14 1705.5 1084 1705.5C1116.86 1705.5 1143.5 1732.14 1143.5 1765Z'
                        fill='#222222'
                        stroke='white'
                        strokeWidth='3'
                    />
                    <path
                        d='M3328 1705V1465H768V1705H3328Z'
                        fill='#222222'
                        stroke='white'
                        strokeWidth='3'
                    />
                    <path
                        d='M1008 865H888V1465H1488V1345C1424.97 1345 1362.55 1332.58 1304.31 1308.46C1246.08 1284.34 1193.16 1248.98 1148.59 1204.41C1104.02 1159.84 1068.66 1106.92 1044.54 1048.69C1020.42 990.452 1008 928.035 1008 865Z'
                        fill='#222222'
                        stroke='white'
                        strokeWidth='3'
                    />
                </g>
                <circle {...PPosition(45)} r='30' stroke='white' strokeWidth='3' fill='#FF0000' />
                <g display={display2 ? undefined : 'none'}>
                    <path
                        d='M1170 1185C1171.1 1185 1172 1184.1 1172 1183C1172 1181.9 1171.1 1181 1170 1181V1185ZM1018.59 1181.59C1017.8 1182.37 1017.8 1183.63 1018.59 1184.41L1031.31 1197.14C1032.09 1197.92 1033.36 1197.92 1034.14 1197.14C1034.92 1196.36 1034.92 1195.09 1034.14 1194.31L1022.83 1183L1034.14 1171.69C1034.92 1170.91 1034.92 1169.64 1034.14 1168.86C1033.36 1168.08 1032.09 1168.08 1031.31 1168.86L1018.59 1181.59ZM1170 1181H1020V1185H1170V1181Z'
                        fill='white'
                    />
                </g>
                <g display={display3 ? undefined : 'none'}>
                    <path
                        d='M1172 1183C1172 1181.9 1171.1 1181 1170 1181C1168.9 1181 1168 1181.9 1168 1183H1172ZM1168.59 1334.41C1169.37 1335.2 1170.63 1335.2 1171.41 1334.41L1184.14 1321.69C1184.92 1320.91 1184.92 1319.64 1184.14 1318.86C1183.36 1318.08 1182.09 1318.08 1181.31 1318.86L1170 1330.17L1158.69 1318.86C1157.91 1318.08 1156.64 1318.08 1155.86 1318.86C1155.08 1319.64 1155.08 1320.91 1155.86 1321.69L1168.59 1334.41ZM1168 1183V1333H1172V1183H1168Z'
                        fill='white'
                    />
                    <path
                        d='M1170.71 1183.71C1171.1 1183.32 1171.1 1182.68 1170.71 1182.29C1170.32 1181.9 1169.68 1181.9 1169.29 1182.29L1170.71 1183.71ZM1021 1331C1021 1331.55 1021.45 1332 1022 1332H1031C1031.55 1332 1032 1331.55 1032 1331C1032 1330.45 1031.55 1330 1031 1330H1023L1023 1322C1023 1321.45 1022.55 1321 1022 1321C1021.45 1321 1021 1321.45 1021 1322V1331ZM1169.29 1182.29L1166.45 1185.14L1167.86 1186.55L1170.71 1183.71L1169.29 1182.29ZM1160.75 1190.83L1155.06 1196.52L1156.48 1197.94L1162.17 1192.25L1160.75 1190.83ZM1149.37 1202.22L1143.68 1207.91L1145.09 1209.32L1150.78 1203.63L1149.37 1202.22ZM1137.99 1213.6L1132.29 1219.29L1133.71 1220.71L1139.4 1215.01L1137.99 1213.6ZM1126.6 1224.99L1120.91 1230.68L1122.32 1232.09L1128.01 1226.4L1126.6 1224.99ZM1115.22 1236.37L1109.52 1242.06L1110.94 1243.48L1116.63 1237.78L1115.22 1236.37ZM1103.83 1247.75L1098.14 1253.45L1099.55 1254.86L1105.25 1249.17L1103.83 1247.75ZM1092.45 1259.14L1086.75 1264.83L1088.17 1266.25L1093.86 1260.55L1092.45 1259.14ZM1081.06 1270.52L1075.37 1276.22L1076.78 1277.63L1082.48 1271.94L1081.06 1270.52ZM1069.68 1281.91L1063.99 1287.6L1065.4 1289.01L1071.09 1283.32L1069.68 1281.91ZM1058.29 1293.29L1052.6 1298.99L1054.01 1300.4L1059.71 1294.71L1058.29 1293.29ZM1046.91 1304.68L1041.22 1310.37L1042.63 1311.78L1048.32 1306.09L1046.91 1304.68ZM1035.52 1316.06L1029.83 1321.75L1031.25 1323.17L1036.94 1317.48L1035.52 1316.06ZM1024.14 1327.45L1021.29 1330.29L1022.71 1331.71L1025.55 1328.86L1024.14 1327.45ZM1171.41 1184.41C1172.2 1183.63 1172.2 1182.37 1171.41 1181.59C1170.63 1180.8 1169.37 1180.8 1168.59 1181.59L1171.41 1184.41ZM1020 1331C1020 1332.1 1020.9 1333 1022 1333H1040C1041.1 1333 1042 1332.1 1042 1331C1042 1329.9 1041.1 1329 1040 1329H1024V1313C1024 1311.9 1023.1 1311 1022 1311C1020.9 1311 1020 1311.9 1020 1313L1020 1331ZM1168.59 1181.59L1165.74 1184.43L1168.57 1187.26L1171.41 1184.41L1168.59 1181.59ZM1160.05 1190.12L1154.36 1195.82L1157.18 1198.64L1162.88 1192.95L1160.05 1190.12ZM1148.66 1201.51L1142.97 1207.2L1145.8 1210.03L1151.49 1204.34L1148.66 1201.51ZM1137.28 1212.89L1131.59 1218.59L1134.41 1221.41L1140.11 1215.72L1137.28 1212.89ZM1125.89 1224.28L1120.2 1229.97L1123.03 1232.8L1128.72 1227.11L1125.89 1224.28ZM1114.51 1235.66L1108.82 1241.36L1111.64 1244.18L1117.34 1238.49L1114.51 1235.66ZM1103.12 1247.05L1097.43 1252.74L1100.26 1255.57L1105.95 1249.88L1103.12 1247.05ZM1091.74 1258.43L1086.05 1264.12L1088.88 1266.95L1094.57 1261.26L1091.74 1258.43ZM1080.36 1269.82L1074.66 1275.51L1077.49 1278.34L1083.18 1272.64L1080.36 1269.82ZM1068.97 1281.2L1063.28 1286.89L1066.11 1289.72L1071.8 1284.03L1068.97 1281.2ZM1057.59 1292.59L1051.89 1298.28L1054.72 1301.11L1060.41 1295.41L1057.59 1292.59ZM1046.2 1303.97L1040.51 1309.66L1043.34 1312.49L1049.03 1306.8L1046.2 1303.97ZM1034.82 1315.36L1029.12 1321.05L1031.95 1323.88L1037.64 1318.18L1034.82 1315.36ZM1023.43 1326.74L1020.59 1329.59L1023.41 1332.41L1026.26 1329.57L1023.43 1326.74Z'
                        fill='white'
                    />
                    <path
                        d='M1168.59 1181.59C1167.8 1182.37 1167.8 1183.63 1168.59 1184.41C1169.37 1185.2 1170.63 1185.2 1171.41 1184.41L1168.59 1181.59ZM1320 1035C1320 1033.9 1319.1 1033 1318 1033H1300C1298.9 1033 1298 1033.9 1298 1035C1298 1036.1 1298.9 1037 1300 1037H1316V1053C1316 1054.1 1316.9 1055 1318 1055C1319.1 1055 1320 1054.1 1320 1053V1035ZM1171.41 1184.41L1319.41 1036.41L1316.59 1033.59L1168.59 1181.59L1171.41 1184.41Z'
                        fill='white'
                    />
                    <path d='M1488 1345V865' stroke='white' strokeWidth='3' strokeDasharray='6 6' />
                    <path
                        d='M1149 1204.41L1488.41 865'
                        stroke='white'
                        strokeWidth='3'
                        strokeDasharray='6 6'
                    />
                </g>
            </svg>
        </div>
    );
};
